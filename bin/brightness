#!/bin/sh -e

for backlight in /sys/class/backlight/*; do
    [ -d "$backlight" ]
    read -r brightness < "$backlight/brightness"
    case "$1" in
        "")
            echo "$brightness"
            exit 0
            ;;
        *%)
            read -r maxBrightness < "$backlight/max_brightness"
            brightness=$((${1%%%} * maxBrightness / 100 + brightness ))
            ;;
        =*)
            brightness=${1#=}
            ;;
        *)
            brightness=$((brightness + $1))
            ;;
    esac
    echo "$brightness" > "$backlight/brightness"
    break
done
